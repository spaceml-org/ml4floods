Search.setIndex({"docnames": ["README", "content/config", "content/intro/introduction", "content/labeling", "content/ml4ops/HOWTO_Calculate_uncertainty_maps", "content/ml4ops/HOWTO_Run_Inference_multioutput_binary", "content/ml4ops/HOWTO_Run_Inference_on_new_data", "content/ml4ops/HOWTO_Train_models", "content/ml4ops/HOWTO_inference_SAFE_file", "content/ml4ops/HOWTO_inference_on_image_time_series", "content/ml4ops/HOWTO_performance_metrics_workflow", "content/ml4ops/HOWTO_postprocess_inference", "content/ml_overview", "content/prep/demo_pytorch_transforms", "content/prep/full_data_ingest", "content/prep/gt_masks_generation", "content/worldfloods_dataset"], "filenames": ["README.md", "content/config.md", "content/intro/introduction.md", "content/labeling.md", "content/ml4ops/HOWTO_Calculate_uncertainty_maps.ipynb", "content/ml4ops/HOWTO_Run_Inference_multioutput_binary.ipynb", "content/ml4ops/HOWTO_Run_Inference_on_new_data.ipynb", "content/ml4ops/HOWTO_Train_models.ipynb", "content/ml4ops/HOWTO_inference_SAFE_file.ipynb", "content/ml4ops/HOWTO_inference_on_image_time_series.ipynb", "content/ml4ops/HOWTO_performance_metrics_workflow.ipynb", "content/ml4ops/HOWTO_postprocess_inference.ipynb", "content/ml_overview.md", "content/prep/demo_pytorch_transforms.ipynb", "content/prep/full_data_ingest.ipynb", "content/prep/gt_masks_generation.ipynb", "content/worldfloods_dataset.md"], "titles": ["Create docs", "Introduction", "Introduction", "Viewer and label editor", "Probabilistic neural networks", "Inference with clouds aware floods segmentation model", "Run inference", "Train models", "Inference on Sentinel-2 <code class=\"docutils literal notranslate\"><span class=\"pre\">SAFE</span></code> files", "Run inference on time series of Sentinel-2 images", "Model Metrics", "Postprocess inference", "MLOps overview", "Pre-processing Demonstration", "Ingest Flood Extent Maps", "Ground Truth", "The <em>WorldFloods</em> database"], "terms": {"instal": [0, 6, 7, 9, 10, 14, 15], "jupyt": [0, 11], "book": 0, "ghp": 0, "import": [0, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16], "from": [0, 1, 4, 6, 9, 10, 11, 12, 13, 15], "main": 0, "directori": [0, 6, 7, 9, 10, 13, 14, 15, 16], "run": [0, 1, 2, 3, 7, 12, 14, 15, 16], "make": [0, 2, 5, 6, 8, 9, 13, 14], "build": [0, 2, 4, 6], "jupyterbook": [0, 6, 7, 15], "check": [0, 14], "local": [0, 4, 6, 7, 8, 9, 10, 13], "look": [0, 11, 14], "good": 0, "upload": [0, 14], "github": [0, 1, 3, 8, 14], "n": [0, 13], "p": [0, 4, 8, 13], "f": [0, 4, 5, 7, 8, 9, 10, 11, 13, 14], "_build": 0, "html": [0, 7, 8], "The": [0, 1, 2, 3, 5, 6, 7, 9, 10, 11, 12, 13, 14], "commit": 0, "should": [0, 4, 5], "appear": [0, 2], "branch": 0, "gh": 0, "page": [0, 1, 7, 9, 16], "live": 0, "spaceml": [0, 3, 8, 14], "org": [0, 3, 8, 14, 16], "io": [0, 7, 8, 9], "ml4flood": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 13, 14, 15], "twine": 0, "first": [0, 7, 9, 11, 13, 15, 16], "updat": 0, "version": [0, 2, 4, 5, 7, 9, 11, 13, 16], "number": [0, 1, 7, 9, 13, 16], "__init__": 0, "py": [0, 3, 5, 7, 8, 9, 11, 14], "rm": 0, "rf": 0, "dist": 0, "python": [0, 1, 3], "setup": 0, "sdist": 0, "bdist_wheel": 0, "testpypi": 0, "m": [0, 8, 9, 11, 14], "repositori": [0, 14], "real": [0, 2, 13], "pypi": 0, "shown": [0, 7, 9], "project": [0, 1, 2, 5, 7, 9, 11, 13, 14, 16], "test": [0, 1, 3, 4, 5, 6, 7, 8, 9, 12, 16], "can": [0, 2, 4, 6, 7, 9, 12, 14, 15, 16], "follow": [0, 3, 5, 6, 7, 9, 10, 11, 13, 14, 15], "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16], "tutori": [0, 2, 4, 6, 7, 8, 9, 10, 12], "understand": [0, 13], "how": [0, 2, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "work": [0, 1, 16], "packag": [1, 3, 5, 7, 8, 9, 14, 15, 16], "do": [1, 5, 6, 9, 11, 13, 14, 15], "end": [1, 2, 7], "flood": [1, 4, 9, 12, 16], "extent": [1, 2, 4, 5, 7, 9, 11, 12, 16], "estim": [1, 4, 7, 9], "optic": [1, 5, 11, 16], "imag": [1, 2, 4, 6, 11, 12, 16], "us": [1, 3, 4, 6, 7, 8, 9, 10, 11, 13, 15, 16], "deep": [1, 2], "learn": [1, 2, 7, 12, 13, 14, 15, 16], "model": [1, 2, 8, 9, 12, 13, 14, 16], "To": [1, 3, 6, 7, 14, 15, 16], "pip": [1, 6, 7, 8, 10, 11, 14, 15], "avail": [1, 5, 7, 8, 11, 13, 14, 15, 16], "publish": 1, "under": [1, 2, 5, 9, 11, 12, 16], "gnu": 1, "lesser": 1, "gpl": 1, "v3": 1, "licenc": [1, 16], "self": [1, 12], "contain": [1, 7, 12, 14, 16], "tool": [1, 15], "train": [1, 2, 8, 9, 11, 12, 13, 15, 16], "deploi": [1, 2, 4, 6, 7, 8, 9, 10], "segment": [1, 2, 6, 7, 9, 10, 11, 12, 15, 16], "sentinel": [1, 6, 12, 15, 16], "2": [1, 2, 12, 16], "landsat": 1, "These": [1, 2, 14, 15], "includ": [1, 2, 4, 13, 14], "download": [1, 3, 4, 11, 12, 14, 15], "map": [1, 2, 4, 7, 11, 12, 15, 16], "acquisit": [1, 2, 9], "neural": [1, 12], "network": [1, 6, 7, 10, 12], "visual": [1, 5, 6, 8, 9, 11, 14, 15], "result": [1, 2, 9, 11], "an": [1, 2, 8, 11, 12, 13, 14, 15, 16], "interact": [1, 14], "see": [1, 2, 6, 7, 8, 9, 10, 11, 14, 15], "rational": 1, "more": [1, 2, 14, 15], "detail": [1, 2, 5, 8, 9, 14, 15], "explan": 1, "mai": [1, 7, 11, 13, 14], "help": [1, 13], "you": [1, 3, 5, 8, 9, 11, 14, 16], "explor": [1, 11, 13, 15], "dataset": [1, 2, 3, 5, 6, 8, 9, 12, 13, 15, 16], "cloud": [1, 2, 4, 6, 7, 8, 10, 11, 12, 14], "awar": [1, 11], "vectoris": 1, "time": [1, 2, 5, 7, 11, 12, 13, 14, 15], "seri": [1, 2, 12], "ml": [1, 2, 13], "step": [1, 2, 13], "infer": [1, 7, 12], "new": [1, 2, 6, 7, 14, 15], "data": [1, 8, 9, 14], "perf": 1, "metric": [1, 7, 12, 13], "ingest": [1, 2, 15], "copernicu": [1, 9, 11, 12, 15, 16], "em": [1, 15, 16], "If": [1, 6, 7, 8, 9, 11, 14, 15, 16], "find": [1, 2, 7, 13, 16], "pleas": [1, 7, 15, 16], "cite": [1, 16], "articl": [1, 16], "portal": [1, 16], "julia_global_2023": [1, 16], "titl": [1, 8, 11, 13, 14, 15, 16], "global": [1, 5, 7, 11, 12, 16], "satellit": [1, 2, 5, 7, 11, 12, 14, 16], "volum": [1, 16], "13": [1, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16], "issn": [1, 16], "2045": [1, 16], "2322": [1, 16], "doi": [1, 5, 11, 16], "10": [1, 4, 5, 7, 8, 9, 10, 11, 13, 14, 15, 16], "1038": [1, 5, 11, 16], "s41598": [1, 5, 11, 16], "023": [1, 5, 11, 16], "47595": [1, 5, 11, 16], "7": [1, 4, 5, 10, 11, 13, 14, 15, 16], "1": [1, 2, 5, 12, 15, 16], "urldat": [1, 16], "2023": [1, 5, 11, 16], "11": [1, 4, 5, 7, 9, 10, 11, 12, 13, 14, 15, 16], "30": [1, 4, 5, 8, 9, 11, 14, 16], "journal": [1, 16], "scientif": [1, 5, 7, 11, 12, 16], "report": [1, 5, 7, 11, 12, 16], "author": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "portal\u00e9": [1, 5, 11, 16], "juli\u00e0": [1, 5, 11, 16], "enriqu": [1, 5, 11, 16], "mateo": [1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], "garc\u00eda": [1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], "gonzalo": [1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], "purcel": [1, 5, 11, 16], "cormac": [1, 16], "g\u00f3mez": [1, 5, 11, 16], "chova": [1, 5, 11, 16], "lui": [1, 16], "month": [1, 16], "nov": [1, 16], "year": [1, 9, 14, 16], "20316": [1, 5, 11, 16], "garcia_towards_2021": [1, 16], "toward": [1, 7, 12, 16], "onboard": [1, 7, 12, 16], "low": [1, 7, 9, 12, 16], "cost": [1, 7, 12, 16], "machin": [1, 2, 6, 7, 12, 13, 14, 15, 16], "021": [1, 16], "86650": [1, 16], "z": [1, 11, 16], "2021": [1, 4, 7, 8, 9, 12, 13, 14, 15, 16], "04": [1, 4, 5, 7, 8, 9, 11, 14, 16], "01": [1, 4, 9, 11, 13, 14, 16], "garcia": [1, 7, 12, 16], "veitch": [1, 16], "micha": [1, 16], "joshua": [1, 16], "smith": [1, 16], "lewi": [1, 16], "oprea": [1, 16], "silviu": [1, 16], "vlad": [1, 16], "schumann": [1, 16], "gui": [1, 9, 16], "gal": [1, 16], "yarin": [1, 16], "baydin": [1, 16], "at\u0131l\u0131m": [1, 16], "g\u00fcne\u015f": [1, 16], "back": [1, 14, 16], "dietmar": [1, 16], "mar": [1, 13, 16], "7249": [1, 7, 12, 16], "extens": 1, "fdl": 1, "europ": 1, "2019": [1, 6, 16], "disast": [1, 2, 14], "prevent": [1, 14], "progress": 1, "respons": [1, 2], "team": [1, 2], "which": [1, 2, 4, 7, 9, 11, 12, 13, 14, 15, 16], "ar": [1, 2, 4, 5, 9, 11, 12, 13, 14, 16], "g": [1, 5, 7, 11, 12], "j": [1, 13, 15], "l": [1, 5, 7, 10, 11], "s": [1, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15], "y": [1, 8, 9, 11, 14], "A": [1, 14, 16], "d": [1, 7, 8, 9, 11, 14, 16], "ha": [1, 7, 14, 15], "been": [1, 7, 16], "further": [1, 13], "extend": [1, 15], "e": [1, 5, 6, 7, 8, 9, 10, 11, 15], "c": [1, 5, 10, 11, 13, 14], "fund": 1, "unit": 1, "kingdom": 1, "space": [1, 2, 7, 14], "agenc": [1, 2], "uksa": 1, "led": 1, "trillium": 1, "technolog": 1, "It": [1, 12, 13, 14, 15, 16], "also": [1, 2, 11, 13, 14, 15], "partial": [1, 5, 11], "support": [1, 2, 4], "spanish": 1, "ministri": 1, "scienc": 1, "innov": 1, "pid2019": 1, "109026rb": 1, "i00": 1, "mineco": 1, "erdf": 1, "mcin": 1, "aei": 1, "13039": 1, "501100011033": 1, "tarun": 1, "narayanan": 1, "emmanuel": [1, 13, 15], "jonhson": 1, "nadia": [1, 13, 14, 15], "ahm": [1, 13, 14, 15], "sam": [1, 4, 6, 7, 10, 12], "budd": [1, 4, 6, 7, 10, 12], "satyarth": [1, 13, 15], "praveen": [1, 13, 15], "luca": 1, "kruitwagen": 1, "margaret": 1, "maynard": 1, "reid": 1, "nichola": [1, 13], "roth": [1, 13], "richard": 1, "strang": 1, "leo": 1, "silverberg": 1, "edoardo": 1, "nemni": 1, "freddi": 1, "kalaitzi": 1, "sara": 1, "jen": 1, "jodi": 1, "hugh": 1, "jame": 1, "parr": 1, "ecosystem": 2, "code": [2, 6, 7, 8, 9, 10, 11, 13, 15], "pipelin": [2, 5, 11, 13, 14], "tackl": 2, "whole": 2, "globe": 2, "revisit": 2, "locat": [2, 11, 14], "everi": 2, "few": [2, 13], "dai": [2, 8, 9, 11, 14], "even": [2, 16], "hour": 2, "record": [2, 16], "chang": [2, 6, 7, 8, 9, 10, 11, 13], "landscap": 2, "Their": 2, "camera": 2, "infrar": 2, "radar": 2, "sensor": [2, 11], "through": [2, 14], "night": 2, "thei": [2, 13, 14], "captur": 2, "inform": [2, 14, 15], "mani": [2, 7, 15], "differ": [2, 5, 7, 9, 11, 14, 15], "observ": [2, 14], "paramet": [2, 5, 7, 13], "dynam": 2, "rapid": 2, "process": [2, 6, 7, 15], "event": [2, 4, 10, 11, 16], "like": [2, 13, 14], "newer": [2, 15], "instrument": [2, 8], "now": [2, 7, 8, 9, 15], "provid": [2, 5, 7, 9, 11, 13, 14], "contextu": 2, "precis": 2, "scale": [2, 14], "instanc": [2, 14], "individu": [2, 14], "search": 2, "rescu": 2, "peopl": [2, 14], "airborn": 2, "platform": [2, 7, 15], "At": 2, "same": [2, 7, 13, 15], "ground": [2, 5, 6, 12, 14, 16], "base": [2, 4, 5, 14, 16], "rain": [2, 14], "gaug": 2, "river": [2, 14, 15], "level": [2, 8], "station": 2, "surfac": 2, "condit": 2, "unavail": 2, "all": [2, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], "store": [2, 7], "sometim": [2, 11], "commerci": [2, 5, 11, 16], "compani": 2, "often": [2, 13], "govern": 2, "open": [2, 4, 5, 12, 13, 14, 15], "restrict": 2, "access": [2, 9, 12, 13, 14], "polici": 2, "howev": [2, 9, 15], "remain": 2, "signific": 2, "barrier": 2, "non": [2, 5, 7, 9, 11, 16], "specialist": 2, "respond": 2, "quickli": 2, "emerg": [2, 14], "situat": 2, "For": [2, 5, 6, 7, 9, 10, 11, 13, 14, 15], "manag": [2, 14], "promis": 2, "translat": 2, "action": [2, 3], "intellig": 2, "directli": [2, 4, 7, 11, 13, 14], "answer": 2, "queri": [2, 4, 5, 9, 14], "area": [2, 9, 12, 14, 15], "continu": [2, 9], "fall": 2, "swell": 2, "up": [2, 5, 13, 14], "next": [2, 6, 7, 9], "show": [2, 3, 5, 6, 8, 10, 11, 12, 13], "me": 2, "water": [2, 4, 5, 7, 8, 9, 10, 11, 12, 16], "stream": [2, 15], "wider": 2, "than": 2, "meter": 2, "algorithm": 2, "have": [2, 6, 7, 9, 12, 13, 14, 15, 16], "potenti": [2, 13], "offer": 2, "significantli": 2, "faster": 2, "accur": 2, "tradit": 2, "method": [2, 7, 8, 14, 15], "adapt": [2, 7], "mean": [2, 7, 9, 10, 11, 13, 14], "easili": [2, 15], "grow": [2, 3], "accommod": 2, "over": [2, 5, 11, 12, 14, 15], "expand": [2, 13], "wide": 2, "rang": [2, 5, 9, 13, 14], "type": [2, 4, 5, 7, 8, 9, 11, 13, 14, 15], "Such": 2, "fusion": 2, "capabl": 2, "game": 2, "broad": 2, "spectrum": 2, "user": [2, 5, 7, 9, 11, 13, 14, 15], "worker": [2, 7], "urban": 2, "planner": 2, "robust": [2, 13], "reliabl": 2, "almost": 2, "art": 2, "form": [2, 7, 15], "requir": [2, 5, 15, 16], "knowledg": 2, "statist": 2, "comput": [2, 5, 9, 12, 13, 14], "workflow": [2, 5, 11], "becom": 2, "much": [2, 15], "becaus": [2, 13, 15], "dedic": 2, "sourc": [2, 14, 15], "librari": [2, 13, 15], "pytorch": [2, 7, 13], "tensorflow": 2, "myriad": 2, "subtl": 2, "pitfal": 2, "associ": [2, 7, 14], "produc": [2, 9, 11], "deepli": 2, "skew": 2, "still": 2, "reason": 2, "untrain": 2, "ey": 2, "integr": 2, "avoid": 2, "creat": [2, 7, 9, 10, 13, 14, 15, 16], "link": [2, 8, 14], "expert": 2, "trust": [2, 9, 14], "incorpor": 2, "calibr": 2, "wrap": 2, "interfac": 2, "full": 2, "embed": 2, "visualis": [2, 4, 5], "enabl": [2, 4], "insight": 2, "gener": [2, 9, 13, 15], "unifi": 2, "suit": 2, "get": [2, 5, 7, 8, 9, 11, 13, 14, 15], "80": 2, "wai": [2, 13], "allow": [2, 11, 14, 15], "straightforward": 2, "customis": 2, "specif": [2, 14, 15, 16], "problem": 2, "sub": [2, 7], "domain": 2, "albania": 2, "made": 2, "practition": 2, "oper": [2, 14], "develop": [2, 5], "infanc": 2, "equival": 2, "devop": 2, "softwar": 2, "analys": 2, "earth": [2, 5, 7, 9, 11, 15], "eo": 2, "highli": 2, "doubli": 2, "complic": 2, "rare": 2, "scientist": 2, "who": [2, 7], "master": 2, "both": [2, 9, 11, 13, 14], "In": [2, 3, 5, 6, 7, 9, 11, 13, 14, 15, 16], "four": [2, 15], "ml4cc": 2, "built": 2, "toolkit": 2, "appli": [2, 4, 5, 7, 9, 10, 11, 12, 13, 14], "easi": [2, 15], "purpos": [2, 6, 13, 14, 15], "carefulli": 2, "design": 2, "cater": 2, "beneficiari": 2, "need": [2, 3, 6, 7, 8, 9, 10, 13, 15, 16], "want": [2, 5, 7, 11, 13, 16], "actual": [2, 15], "just": [2, 4, 9, 15], "relief": 2, "effort": 2, "risk": [2, 14], "analyst": 2, "past": 2, "collat": 2, "research": [2, 13], "investig": 2, "better": 2, "figur": [2, 8, 9, 13, 14], "below": [2, 5, 13, 14, 15], "present": [2, 14], "overview": [2, 15], "alongsid": 2, "each": [2, 9, 12, 13, 14], "compon": [2, 13], "click": 2, "larger": 2, "structur": [2, 6, 13], "sort": 2, "organis": 2, "truth": [2, 5, 6, 12, 14, 16], "mask": [2, 7, 14, 16], "tile": [2, 4, 6, 7, 8, 9, 10, 11], "augment": [2, 13], "normalis": 2, "3": [2, 5], "exist": [2, 6, 7, 8, 9, 10, 11, 14, 15], "displai": [2, 12], "uncertainti": 2, "4": [2, 5, 14, 15], "via": [2, 4, 13], "web": [2, 3, 9], "applic": [2, 3, 9, 13], "program": 2, "api": [2, 8, 15], "so": [2, 9, 14, 15], "technic": 2, "fine": 2, "tune": 2, "adopt": 2, "own": [2, 9], "graphic": 2, "simpl": [2, 13, 15], "point": [2, 13, 14], "last": [2, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14], "place": [2, 5, 15], "power": 2, "hand": 2, "ordinari": 2, "coordin": [2, 5, 8, 9, 11, 15], "final": [2, 9, 15], "incred": 2, "them": [2, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15], "compar": 2, "contrast": 2, "greatli": 2, "speed": 2, "flask": 3, "view": [3, 7], "manual": [3, 16], "edit": [3, 13], "floodmap": [3, 5], "worldflood": [3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15], "we": [3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "keep": [3, 15], "improv": [3, 7], "qualiti": 3, "its": [3, 14], "order": [3, 6, 7, 8, 9, 13, 15], "least": [3, 7], "subset": [3, 7, 16], "launch": [3, 14], "clone": [3, 14], "git": [3, 6, 8, 14, 15], "com": [3, 5, 6, 7, 8, 9, 10, 11, 14, 15], "cd": 3, "serv": [3, 13, 15], "root_loc": 3, "path": [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "worldfloods_v1_0": [3, 5, 6, 7, 10, 12, 16], "gt_version": 3, "v1": [3, 4, 7, 8, 10, 15], "no_save_floodmap_bucket": 3, "video": 3, "modifi": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "07": [4, 7, 9, 11, 14], "measur": 4, "basic": [4, 15], "gcp": [4, 9, 14, 16], "credenti": [4, 9], "sy": [4, 5, 7, 9, 11, 13, 14, 15], "os": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "pathlib": [4, 13, 14], "load_ext": [4, 13], "autoreload": [4, 13], "devic": [4, 7], "gc": [4, 7], "config_setup": [4, 6, 7, 8, 9, 10], "get_default_config": [4, 6, 7, 8, 9, 10], "pkg_resourc": [4, 7], "set": [4, 5, 6, 9, 10, 11, 13, 14, 15], "filepath": [4, 7], "config_fp": [4, 6, 7, 8, 9, 10], "worldfloods_templ": [4, 7], "json": [4, 5, 6, 7, 8, 9, 10, 11, 13, 16], "resource_filenam": [4, 7], "worldfloods_uncertainti": 4, "join": [4, 6, 7, 8, 9, 10, 15], "root": [4, 13], "src": [4, 13, 15], "config": [4, 5, 7, 8, 11, 16], "experi": [4, 6, 8, 9, 10], "worldfloods_uncertainty_demo": 4, "data_param": [4, 5, 6, 7, 8, 9, 10, 11, 13], "batch_siz": [4, 6, 7, 8, 9, 10, 13], "32": [4, 6, 7, 8, 9, 10, 11, 14], "bucket_id": [4, 6, 7, 8, 9, 10, 13], "channel_configur": [4, 5, 6, 7, 8, 9, 10, 11], "filter_window": [4, 6, 7, 8, 9, 10], "fals": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "threshold_cloud": [4, 7], "8": [4, 5, 6, 8, 9, 10, 13, 14, 15], "input_fold": [4, 6, 7, 8, 9, 10, 13], "s2": [4, 5, 6, 7, 8, 10, 11, 13, 14], "loader_typ": [4, 6, 7, 8, 9, 10], "num_work": [4, 6, 7, 8, 9, 10], "path_to_split": [4, 6, 7, 8, 9, 10, 13], "public": [4, 5, 8, 9, 11, 13, 16], "target_fold": [4, 6, 7, 8, 9, 10, 13], "gt": [4, 5, 6, 7, 8, 9, 10, 13, 15], "test_transform": [4, 6, 7, 8, 9, 10, 13], "normal": [4, 5, 6, 7, 8, 9, 10], "true": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "train_test_split_fil": [4, 6, 7, 8, 9, 10], "train_test_split": [4, 6, 7, 8, 9, 10], "train_transform": [4, 6, 7, 8, 9, 10, 13], "window_s": [4, 6, 7, 8, 9, 10, 13], "256": [4, 6, 7, 8, 9, 10, 13], "experiment_nam": [4, 5, 6, 7, 8, 9, 10, 11], "gpu": [4, 6, 7, 8, 9, 10, 11], "model_param": [4, 5, 6, 7, 8, 9, 10], "hyperparamet": [4, 5, 6, 7, 8, 9, 10], "label_nam": [4, 6, 7, 8, 9, 10], "land": [4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], "lr": [4, 6, 7, 8, 9, 10], "0001": [4, 6, 7, 8, 9, 10], "lr_decai": [4, 6, 7, 8, 9, 10], "lr_patienc": [4, 6, 7, 8, 9, 10], "max_epoch": [4, 6, 7, 8, 9, 10], "40": [4, 8, 9], "max_tile_s": [4, 5, 6, 7, 8, 9, 10, 11], "model_typ": [4, 6, 7, 8, 9, 10], "unet_dropout": 4, "num_channel": [4, 6, 7, 8, 9, 10], "num_class": [4, 6, 7, 8, 9, 10, 13], "val_everi": [4, 6, 7, 8, 9, 10], "weight_per_class": [4, 6, 7, 8, 9, 10], "93445299": [4, 6, 7, 8, 9, 10], "36": [4, 6, 7, 8, 9, 10], "60054169": [4, 6, 7, 8, 9, 10], "19400729": [4, 6, 7, 8, 9, 10], "model_fold": [4, 6, 7, 8, 9, 10], "gs": [4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16], "ml4cc_data_lak": [4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16], "0_dev": [4, 6, 7, 8, 9, 10, 13, 14, 15], "2_mart": [4, 5, 6, 7, 8, 9, 10, 12, 16], "2_mlmodelmart": [4, 6, 7, 8, 9, 10, 16], "path_to_weight": [4, 6, 8, 9, 10], "use_pretrained_weight": [4, 6, 8, 9, 10], "resume_from_checkpoint": [4, 6, 7, 8, 9, 10], "seed": [4, 6, 8, 9, 10], "12": [4, 5, 6, 7, 8, 9, 10, 11, 14], "one": [4, 7, 9, 11, 15, 16], "assum": [4, 7], "alreadi": [4, 5, 7, 13, 14, 15], "save": [4, 6, 11], "bucket": [4, 7, 9, 10, 11, 13, 14], "specifi": [4, 7, 14], "dataset_setup": [4, 7, 10], "folder": [4, 5, 8, 9, 14, 16], "val": [4, 5, 6, 10, 16], "onli": [4, 7, 11, 13, 14, 16], "data_modul": [4, 10], "get_dataset": [4, 7], "dl": [4, 7, 10], "test_dataload": [4, 7], "89741": 4, "1284": [4, 7, 10], "current": [4, 7, 9, 16], "achiev": 4, "dropout": [4, 12], "dure": [4, 14], "pytorch_lightn": [4, 7], "util": [4, 7, 10, 11, 14, 15], "cloud_io": [4, 7], "model_setup": [4, 5, 6, 7, 8, 9, 10, 11], "get_model": [4, 6, 7, 8, 9, 10], "torch": [4, 5, 6, 7, 8, 9, 10, 11, 13], "print": [4, 6, 7, 8, 9, 10, 11, 13, 14, 15], "path_to_model": 4, "pt": [4, 5, 6, 7, 8, 9, 11, 16], "sampl": [4, 13], "vari": 4, "predict": [4, 5, 6, 8, 9, 12], "prob_model": 4, "load_state_dict": 4, "cuda": [4, 6, 7, 8, 9, 10], "determinist": 4, "consist": [4, 15], "det_model": 4, "worldfloodsmodel": [4, 6, 7, 10], "dconv_down1": [4, 6, 10], "sequenti": [4, 6, 7, 10], "conv2d": [4, 6, 7, 10], "64": [4, 5, 6, 7, 10, 11, 13, 15], "kernel_s": [4, 6, 7, 10], "stride": [4, 6, 7, 10], "pad": [4, 6, 7, 10], "relu": [4, 6, 7, 10], "inplac": [4, 6, 7, 10], "dconv_down2": [4, 6, 10], "128": [4, 6, 7, 8, 9, 10], "dconv_down3": [4, 6, 10], "dconv_down4": [4, 6, 10], "512": [4, 6, 10], "maxpool": [4, 6, 10], "maxpool2d": [4, 6, 10], "dilat": [4, 6, 10], "ceil_mod": [4, 6, 10], "dconv_up3": [4, 6, 10], "768": [4, 6, 10], "dconv_up2": [4, 6, 10], "384": [4, 6, 10], "dconv_up1": [4, 6, 10], "192": [4, 6, 10], "dropout2d": 4, "conv_last": [4, 6, 10], "handl": [4, 5, 7, 15], "larg": [4, 6], "multipl": [4, 7, 13, 14], "obtain": [4, 9, 12, 14, 15], "eval_mod": 4, "give": 4, "get_model_inference_funct": [4, 6, 7, 8, 9, 10], "prob_inference_funct": 4, "apply_norm": [4, 6, 7, 8, 9, 10], "det_inference_funct": 4, "compute_unecertainti": 4, "num_sampl": 4, "sever": [4, 11, 14], "compute_uncertainti": 4, "p_pred_fun": 4, "d_pred_fun": 4, "00": [4, 5, 6, 7, 8, 9, 10, 11, 14, 15], "max": [4, 6, 7, 8, 9, 10, 11, 13, 14], "size": [4, 6, 7, 8, 9, 10, 11, 13], "1024": [4, 5, 7, 10, 11], "9": [4, 7, 9, 10], "14": [4, 5, 7, 9, 13, 14, 15], "02": [4, 5, 8, 9, 10, 11, 14, 15], "27": [4, 5, 11], "78": [4, 7, 9, 11], "18": [4, 7, 8, 9, 10, 11, 14], "16": [4, 5, 6, 7, 8, 9, 11, 14, 15], "17": [4, 6, 7, 9, 10, 15], "20": [4, 8, 9, 11, 13, 14], "44": [4, 8, 9], "60": [4, 5, 11], "35": [4, 5, 7, 11, 15], "45": [4, 9, 11], "29": [4, 8, 9, 14], "51": [4, 8, 9], "55": [4, 8, 9, 14], "53": [4, 7, 8, 9, 14], "34": [4, 9, 11], "65": 4, "03": [4, 5, 6, 9, 10, 11, 13, 14, 15], "56": [4, 7, 9, 11], "59": [4, 9, 10, 14], "73": [4, 5, 7, 10, 11], "05": [4, 5, 7, 8, 9, 10, 11, 14], "47": [4, 9], "75": [4, 7, 9, 11], "81": [4, 7, 10], "82": [4, 7, 9], "06": [4, 11, 13, 14], "91": [4, 7, 9, 10, 11], "46": [4, 6, 11, 13], "rasterio": [4, 5, 8, 11, 13, 15], "numpi": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "np": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "plot": [4, 10, 11, 14], "rasterioplt": [4, 5, 13, 15], "matplotlib": [4, 5, 6, 7, 8, 9, 11, 13, 14, 15], "pyplot": [4, 5, 6, 7, 8, 9, 11, 13, 14, 15], "plt": [4, 5, 6, 7, 8, 9, 11, 13, 14, 15], "color": [4, 5, 9, 11, 14, 15], "patch": [4, 5, 6, 9, 15], "mpatch": [4, 5], "option": [4, 5], "tupl": [4, 5], "union": [4, 5], "bands_s2": [4, 5], "no_grad": [4, 5], "def": [4, 5, 9, 10, 11, 13], "read_inference_pair": [4, 5], "tiff_input": [4, 5], "str": [4, 5, 8, 13], "folder_ground_truth": [4, 5], "window": [4, 5, 6, 9], "slice": [4, 5], "return_ground_truth": [4, 5], "bool": [4, 5], "channel": [4, 5, 6, 9, 11, 16], "none": [4, 5, 6, 7, 8, 9, 10, 13, 14, 15], "folder_permanent_wat": [4, 5], "tensor": [4, 5, 8, 11], "affin": [4, 5, 8, 15], "read": [4, 6, 7, 10, 13, 15], "pair": [4, 5, 16], "layer": [4, 5, 6, 9, 14, 15], "return": [4, 5, 8, 9, 10, 11, 15], "pass": [4, 5, 7], "transform": [4, 5, 6, 8, 9, 10, 11, 15], "lat": [4, 5, 9], "long": [4, 5, 6, 7, 8, 9], "arg": [4, 5, 7, 11], "filenam": [4, 5, 8, 9, 11, 14], "name": [4, 5, 6, 7, 8, 9, 11, 14, 15], "replac": [4, 5, 9, 11], "input": [4, 5, 6, 9], "flag": [4, 5, 7], "indic": [4, 5, 14, 15], "list": [4, 5, 6, 9, 14], "return_permanent_wat": [4, 5], "perman": [4, 5, 6, 9], "raster": [4, 5], "torch_input": [4, 5, 6, 8, 9, 11], "torch_target": [4, 5, 6], "tiff_target": [4, 5], "r": [4, 5, 6, 7, 8, 13, 15], "rst": [4, 5], "arrai": [4, 5, 11, 14, 15], "tolist": [4, 5, 7, 9, 10, 11, 14], "shift": [4, 5], "given": [4, 5], "els": [4, 5, 7, 9, 10, 11, 14], "astyp": [4, 5, 11, 13], "float32": [4, 5, 11, 15], "unsqueez": [4, 5, 6, 8, 9], "tiff_permanent_wat": [4, 5], "permanent_wat": [4, 5], "torch_permanent_wat": [4, 5, 6], "zeros_lik": [4, 5], "target": [4, 5], "colors_worldflood": [4, 5], "invalid": [4, 5, 6, 11, 15], "139": [4, 5, 11, 15], "220": [4, 5, 11], "dtype": [4, 5, 8, 9, 10, 11, 14, 15], "255": [4, 5, 11, 13, 15], "interpretation_worldflood": [4, 5], "colors_worldfloods_perman": [4, 5], "237": [4, 5], "flood_wat": [4, 5], "85": [4, 5, 7, 10, 11], "92": [4, 5, 7, 10, 11], "seasonal_wat": [4, 5], "interpretation_worldfloods_perman": [4, 5], "season": [4, 5], "get_channel_configuration_band": [4, 5, 6, 9, 10, 11], "col_off": [4, 5], "1543": [4, 5], "row_off": [4, 5], "247": [4, 5], "width": [4, 5, 13], "2000": [4, 5], "height": [4, 5, 13], "tiff_s2": [4, 5, 6], "1_stage": [4, 5, 13, 15], "emsr501": [4, 5, 13, 14, 15], "aoi01": [4, 5, 13, 14, 15], "emsr501_aoi01_del_monit01_r1_v1": [4, 5, 13], "tif": [4, 5, 6, 9, 10, 11, 13, 14, 15], "v_1_1": [4, 5, 13], "jrc": [4, 5, 6, 9, 15], "compute_uncertainties_for_image_pair": 4, "denorm": 4, "notebook": [5, 7, 8, 9, 11, 13, 14, 15], "propos": [5, 11], "With": [5, 6, 9, 14], "abl": [5, 9, 12, 15], "correctli": [5, 14], "classifi": 5, "cover": [5, 11], "thin": 5, "semi": [5, 16], "transpar": 5, "scheme": 5, "multioutput": [5, 11, 12, 15], "output": [5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "class": [5, 7, 10, 11], "rule": 5, "huggingface_hub": [5, 11], "hf_hub_download": [5, 11], "georead": [5, 11], "geotensor": [5, 11], "shape": [5, 7, 8, 9, 10, 11, 14, 15], "geometri": [5, 6, 8, 9, 11, 14, 15], "reader": [5, 11], "ee_queri": [5, 11], "ee_imag": [5, 11], "datetim": [5, 8, 9, 11, 14], "ee": [5, 9, 11, 14], "plot_util": [5, 6, 8, 9, 11, 14, 15], "our": [5, 6, 7, 10, 14, 15], "huggingfac": 5, "repo": 5, "unet": [5, 6, 7, 8, 9, 10], "l8": 5, "paper": [5, 16], "case": [5, 13, 14, 15], "variabl": [5, 7, 9], "accord": 5, "wf2_unetv2_al": 5, "wf2_unetv2_bgriswir": [5, 11], "rgbnir": 5, "wf2_unetv2_rgbi": 5, "subfolder_loc": [5, 11], "config_fil": [5, 11], "repo_id": [5, 11], "isp": [5, 11], "uv": [5, 11], "es": [5, 11], "subfold": [5, 7, 11], "local_dir": [5, 11], "local_dir_use_symlink": [5, 11], "model_fil": [5, 11], "script": [5, 7, 11], "load_inference_funct": [5, 11], "device_nam": [5, 11], "cpu": [5, 6, 7, 8, 9, 11, 15], "th_water": [5, 11], "0": [5, 9, 11, 13, 14], "5": [5, 6, 11, 14, 15], "th_bright": [5, 11], "3500": [5, 7, 11], "collection_nam": [5, 11], "weight": [5, 6, 8, 9, 10, 11], "input_tensor": [5, 11], "nan_to_num": [5, 11], "authent": [5, 9, 11, 14], "initi": [5, 8, 9, 11, 13, 14, 15], "aoi": [5, 11, 14], "polygon": [5, 9, 11, 14, 15], "153": 5, "20789834941638": 5, "28": [5, 9, 11, 14], "75874177524779": 5, "91332819718112": 5, "38848611797107": 5, "s2data": 5, "2022": [5, 6, 9, 10, 14, 15], "producttyp": [5, 8, 11], "as_str": 5, "asset_id": [5, 11], "iloc": [5, 8, 9], "gee_id": [5, 11], "geom": [5, 11], "intersect": [5, 11], "postflood": [5, 11], "export_image_getpixel": [5, 11], "proj": [5, 8, 11], "bands_ge": [5, 11], "home": [5, 6, 7, 8, 9, 11, 13, 14, 15], "mambaforg": [5, 11], "env": [5, 7, 8, 9, 11], "ml4floods2": [5, 11], "lib": [5, 7, 8, 9, 11], "python3": [5, 7, 8, 9, 11], "site": [5, 7, 8, 9, 11], "geopanda": [5, 6, 8, 9, 11, 14, 15], "geoseri": [5, 11], "645": [5, 11], "futurewarn": [5, 8, 9, 11], "convert_dtyp": [5, 11], "deprec": [5, 8, 9, 11, 14], "remov": [5, 9, 11, 12], "futur": [5, 9, 11, 13], "ser": [5, 11], "object": [5, 6, 7, 8, 9, 11, 13, 14, 15], "instead": [5, 9, 11, 14], "super": [5, 11, 14], "func": [5, 11], "kwarg": [5, 7, 11], "warn": [5, 7, 11, 13, 14, 15], "tiffreaddirectori": [5, 11], "sum": [5, 11], "photometr": [5, 11], "relat": [5, 11], "extrasampl": [5, 11], "doesn": [5, 11], "t": [5, 11, 13, 14], "match": [5, 11], "samplesperpixel": [5, 11], "defin": [5, 13], "520260": 5, "6818730": 5, "6": [5, 6, 8, 10, 11, 14], "1717": 5, "1766": 5, "resolut": [5, 11], "bound": [5, 8, 9, 11, 14, 15], "6801560": 5, "537920": 5, "cr": [5, 8, 9, 11, 14, 15], "epsg": [5, 8, 11, 14], "32756": 5, "fill_value_default": [5, 11], "prediction_postflood": [5, 11], "prediction_postflood_cont": [5, 11], "valu": [5, 6, 7, 9, 10, 11, 14], "len": [5, 6, 8, 9, 10, 11, 13], "prediction_postflood_rast": [5, 11], "1min": [5, 11], "15": [5, 8, 9, 11, 14, 15], "total": [5, 7, 9, 11, 13, 15], "43": 5, "wall": [5, 7, 9, 11, 15], "colors_pr": [5, 11], "240": [5, 11], "flood_trac": [5, 11], "fig": [5, 6, 7, 8, 9, 11, 13, 14, 15], "ax": [5, 6, 7, 8, 9, 11, 13, 14, 15], "subplot": [5, 6, 7, 8, 9, 11, 13, 14, 15], "figsiz": [5, 6, 7, 8, 9, 11, 13, 14, 15], "isel": 5, "band": [5, 8, 9, 10, 11, 14, 15], "3_500": 5, "clip": [5, 9, 11, 13, 14], "add_scalebar": [5, 11], "set_titl": [5, 6, 11], "solardai": [5, 11], "plot_segmentation_mask": [5, 11], "interpretation_arrai": [5, 11], "text": [5, 11, 13, 15], "satdata": 5, "bands_landsat": 5, "postfloodl8": 5, "10000": [5, 11], "131": 5, "ms": [5, 7, 8, 11], "33": [5, 9, 11], "165": 5, "89": [5, 7, 9, 10, 11], "520245": 5, "3181245": 5, "573": 5, "590": 5, "3198435": 5, "537945": 5, "32656": 5, "inf": 5, "prediction_postfloodl8": 5, "prediction_postflood_contl8": 5, "prediction_postfloodl8_rast": 5, "61": [5, 7], "publicli": 5, "environ": [5, 6, 7, 9, 10, 11], "google_application_credenti": [5, 7, 9], "gcc_pai": 5, "gs_user_project": [5, 7, 9], "your": [5, 6, 7, 8, 9, 10, 14, 15, 16], "cuda_visible_devic": 5, "cache_fold": 5, "startswith": [5, 11], "download_tiff": 5, "gt_with_permanent_wat": 5, "ndarrai": 5, "taken": 5, "http": [5, 6, 7, 8, 9, 10, 11, 14, 15, 16], "googl": [5, 8, 9, 11, 12], "engin": [5, 9, 11, 15], "catalog": 5, "jrc_gsw1_2_yearlyhistori": 5, "get_cmap_norm_color": [5, 15], "color_arrai": 5, "cmap_categor": 5, "listedcolormap": 5, "norm_categor": 5, "vmin": [5, 15], "vmax": [5, 15], "interp": [5, 13], "zip": [5, 7, 8, 16], "append": [5, 9, 11, 13, 14], "label": [5, 14, 15], "plot_inference_set": 5, "softmax": [5, 7, 10], "argmax": [5, 6, 7, 8, 9], "inputs_show": 5, "squeez": [5, 11], "targets_show": 5, "permanent_water_show": 5, "categori": 5, "cmap_pr": 5, "norm_pr": 5, "patches_pr": 5, "cmap_gt": 5, "norm_gt": 5, "patches_gt": 5, "prediction_show": 5, "band_names_current_imag": 5, "iband": 5, "bands_rgb": 5, "index": [5, 9, 11, 13, 14], "b": [5, 10, 14], "b4": [5, 7, 9, 11, 14], "b3": [5, 11, 14], "b2": [5, 11, 14], "swir_1": 5, "nir": [5, 6, 9, 14], "red": [5, 9, 14, 15], "composit": [5, 6, 13, 14], "bands_false_composit": 5, "b11": [5, 7, 9, 11, 14], "b8": [5, 7, 9, 11, 14], "false_rgb": 5, "3000": [5, 9, 11, 13, 14], "rgb": [5, 6, 13, 14], "swir1": [5, 6], "legend": [5, 6, 8, 11, 15], "loc": [5, 11, 14, 15], "upper": [5, 15], "right": [5, 15], "download_imag": 5, "tiffs_for_infer": 5, "makedir": [5, 6, 7, 8, 9, 10, 11, 14, 15], "exist_ok": [5, 6, 7, 8, 9, 10, 11, 14, 15], "emsr333_02portopalo_del_monit01_v1_observed_event_a": [5, 10], "1000": [5, 9, 14], "400": 5, "permanentwaterjrc": [5, 6, 15], "cont_pr": 5, "h": [5, 6, 8, 9, 10, 11], "w": [5, 6, 7, 8, 9, 10], "4_860": 5, "3_300": 5, "840": 5, "2_prod": [5, 6, 7, 8, 10, 12, 16], "emsr342_06northnormanton_del_v1_observed_event_a": [5, 10], "1_600": 5, "emsr271_02farkadona_del_v1_observed_event_a": 5, "rs2_20161008_water_extent_corail_pestel": [5, 6], "1_200": 5, "1_500": 5, "st1_20161014_waterextent_binhdinh_lak": 5, "emsr347_07zomba_del_monit01_v1_observed_event_a": [5, 10], "databas": [5, 11, 15], "pre": [5, 10, 11, 15, 16], "releas": [5, 11, 16], "creativ": [5, 11, 16], "common": [5, 11, 16], "comerci": [5, 11], "written": [5, 11], "consent": [5, 11], "must": [5, 7, 11], "file": [6, 10, 11, 12, 15], "note": [6, 7, 9, 10, 11, 15], "necesari": 6, "pretrain": [6, 12, 16], "geotiff": 6, "drive": [6, 7, 8, 9, 10, 15], "other": [6, 7, 9, 10, 13, 14, 15], "altern": [6, 7, 9, 10, 16], "document": [6, 7, 10, 15], "re": [6, 7, 8, 9, 10, 13, 15], "add": [6, 7, 8, 9, 10, 11, 15, 16], "shortcut": [6, 7, 8, 9, 10, 15, 16], "Then": [6, 7, 9, 10], "try": [6, 7, 8, 9, 10, 15], "content": [6, 7, 8, 9, 10, 12, 14, 15, 16], "assert": [6, 7, 8, 9, 10, 15], "my": [6, 7, 8, 9, 10, 14, 15, 16], "u": [6, 7, 8, 9, 10, 12, 15, 16], "1dqfywetx614r49kuve3cbzwvo6qhvrvh": [6, 7, 8, 9, 10, 15], "google_colab": [6, 7, 8, 9, 10, 15], "path_to_dataset_fold": [6, 7, 8, 9, 10, 15], "dataset_fold": [6, 7, 8, 9, 10], "worldfloods_v1_0_sampl": [6, 7, 8, 9, 10], "wfv1_unet": [6, 8, 9, 10, 16], "folder_name_model_weight": [6, 8, 9, 10], "except": [6, 7, 8, 9, 10, 15], "importerror": [6, 7, 8, 9, 10, 15], "No": [6, 7, 9, 15], "modul": [6, 7, 9, 13, 14, 15], "val_fold": 6, "download_fold": [6, 8, 9, 10], "id": [6, 7, 8, 9, 10, 14, 15, 16], "1oup": [6, 8, 9, 10], "qvd1u": [6, 8, 9, 10], "re3liqkw7tokjsdu90blsk": [6, 8, 9, 10], "quiet": [6, 8, 9, 10, 14], "use_cooki": [6, 8, 9, 10], "1ogcnupgr0q6nlws7bbqq8pzilyonah12": 6, "usp": [6, 7, 10], "share": [6, 7, 10], "retriev": 6, "1vk48dyx5dq9jzdmx9m8z": 6, "eznqcma7kjg": 6, "1mdquzvl45_gtiilsdneb": [6, 9], "un8xnroskyc": [6, 9], "complet": 6, "uc": [6, 15], "ml4op": [6, 7], "100": [6, 7, 8, 9, 10, 14, 15], "20k": 6, "629kb": 6, "31": [6, 9, 11], "2m": 6, "3mb": 6, "param": [6, 7, 9, 13], "control": [6, 7, 9, 11], "fed": [6, 9], "nn": [6, 9], "memori": [6, 9], "contrain": 6, "totensor": [6, 8, 9, 10, 13], "25": [6, 7, 8, 9, 10, 11, 14, 15], "checkpoint": [6, 7, 8, 9, 10], "wandb_ent": [6, 7, 8, 9, 10], "wandb_project": [6, 7, 8, 9, 10], "dirnam": [6, 10, 15], "eval": [6, 10], "comment": 6, "line": [6, 14], "doe": [6, 7, 13, 14], "inference_funct": [6, 7, 9, 10, 11], "function": [6, 7, 8, 9, 10, 11, 13, 14, 15], "let": [6, 13, 14, 15], "stich": 6, "strategi": 6, "describ": 6, "huang": 6, "et": [6, 7, 12, 15], "al": [6, 7, 12, 15], "cell": [6, 7, 9, 11, 14], "afterward": [6, 9], "comparison": 6, "event_id": 6, "tiff_gt": 6, "tiff_permanentwaterjrc": 6, "load_input": [6, 9], "dim": [6, 7, 8, 9], "pixel": [6, 9, 15, 16], "mask_invalid": [6, 8, 9], "_": [6, 7, 10], "plot_rgb_imag": [6, 8, 14, 15], "plot_swirnirred_imag": [6, 8, 9, 11], "plot_gt_v1_with_perman": 6, "plot_gt_v1": [6, 8, 9, 15], "tight_layout": [6, 7, 8, 9], "bellow": [6, 9], "data_out": 6, "geodatafram": [6, 8, 9, 11, 14], "shapefil": 6, "save_fil": 6, "postprocess": [6, 8, 9], "gpd": [6, 8, 9, 11, 14, 15], "prob_water_mask": [6, 8, 9], "binary_water_mask": [6, 8, 9], "geoms_polygon": [6, 8, 9], "get_water_polygon": [6, 8, 9], "arang": [6, 7, 8, 9, 10], "categor": [6, 8], "facecolor": [6, 8, 14, 15], "edgecolor": [6, 8, 14], "linewidth": [6, 8, 14, 15], "alpha": [6, 8], "axessubplot": [6, 8, 9, 14, 15], "artifici": 7, "intelig": 7, "monitor": [7, 14], "onlin": [7, 8, 16], "cours": 7, "futurelearn": 7, "public_fold": 7, "gdown": [7, 8, 9, 14, 15, 16], "could": [7, 9, 15], "tri": 7, "zipfil": [7, 8], "validate_worldfloods_data": 7, "filenotfounderror": 7, "zip_file_nam": 7, "7gb": 7, "11o6akzk4r6derix32o4mmtj5dtzrrkgv": [7, 16], "zip_ref": [7, 8], "extractal": [7, 8], "close": [7, 8], "expect": [7, 8, 14], "format": [7, 8, 14], "load": [7, 9, 12, 13, 14, 15], "either": [7, 9], "copi": [7, 13, 15], "hyper": 7, "out": [7, 10], "worldfloods_demo_test": 7, "early_stopping_pati": 7, "metric_monitor": 7, "val_dice_loss": 7, "linear": 7, "model_vers": [7, 10], "seed_everyth": 7, "training_demo": 7, "found": [7, 8, 9, 14, 15], "trigger": 7, "264": 7, "29gb": 7, "custom": [7, 9, 13], "train_test_split_sampl": 7, "depend": [7, 13], "product": [7, 14, 15], "6298": [7, 10], "98": [7, 9, 10], "63": 7, "103": 7, "169": 7, "pytorch_lightin": 7, "datamodul": 7, "attribut": 7, "train_dataset": 7, "val_dataset": 7, "test_dataset": [7, 10], "addit": [7, 15, 16], "train_dataload": 7, "val_dataload": [7, 10], "train_dl": 7, "train_dl_it": 7, "iter": [7, 9], "batch": [7, 14], "worldfloods_model": 7, "n_imag": 7, "plot_batch": 7, "max_clip_v": 7, "bands_show": 7, "4500": 7, "plot_batch_output_v1": 7, "show_axi": 7, "scratch": [7, 12], "construct": 7, "simplecnn": 7, "implement": 7, "conv": 7, "later": [7, 13, 14], "automatical": 7, "log": 7, "relev": 7, "wandb": 7, "setup_weights_and_bias": 7, "wandblogg": 7, "uncom": 7, "ON": 7, "TO": 7, "login": 7, "done": 7, "onc": [7, 14], "init": [7, 8], "demo": 7, "wandb_logg": 7, "entiti": 7, "modelcheckpoint": 7, "best": 7, "perform": [7, 13], "storag": [7, 9, 14, 16], "earli": 7, "stop": 7, "earlystop": 7, "after": [7, 14], "epoch": 7, "latest": [7, 16], "experiment_path": 7, "checkpoint_callback": 7, "dirpath": 7, "save_top_k": 7, "verbos": [7, 9], "mode": [7, 11, 16], "min": [7, 9, 11, 13, 14], "early_stop_callback": 7, "patienc": 7, "strict": 7, "rest": 7, "readthedoc": 7, "en": 7, "maximum": 7, "fast_dev_run": 7, "default_root_dir": 7, "accumulate_grad_batch": 7, "gradient_clip_v": 7, "auto_lr_find": 7, "benchmark": 7, "check_val_every_n_epoch": 7, "log_gpu_memori": 7, "tpu": 7, "core": 7, "ipu": 7, "miniconda3": [7, 8, 9], "1580": 7, "userwarn": [7, 9], "rank_zero_warn": 7, "fit": 7, "34m": 7, "1mwandb": 7, "0m": [7, 14], "33mipl_uv": 7, "relogin": 7, "forc": 7, "upgrad": 7, "track": 7, "21": [7, 9, 14, 15], "sync": 7, "ai": 7, "2b206f4a": 7, "20210408_084312": 7, "266": 7, "k": 7, "trainabl": 7, "065": 7, "mb": [7, 8], "opt": [7, 13], "distribut": 7, "50": [7, 10, 11], "bottleneck": 7, "consid": 7, "increas": 7, "argument": 7, "393": 7, "reach": 7, "60017": 7, "ckpt": 7, "top": [7, 15], "787": 7, "59220": 7, "1181": 7, "56052": 7, "1575": 7, "55334": 7, "befor": [7, 9, 13, 14], "logit": 7, "prob": 7, "ravel": 7, "grid": [7, 9, 14], "panda": [7, 9, 10, 14], "pd": [7, 9, 10, 14], "activ": [7, 10], "otherwis": [7, 10], "fail": [7, 9, 10, 11], "when": [7, 8, 10, 14], "remot": [7, 10], "set_num_thread": [7, 10], "thresholds_wat": [7, 10], "1e": [7, 10, 13], "96": [7, 9, 10], "99": [7, 9, 10, 11], "995": [7, 10], "999": [7, 10], "met": [7, 10], "compute_metr": [7, 10], "convert_target": [7, 10], "plot_metr": [7, 10], "81it": 7, "52": 7, "55it": 7, "per": [7, 10, 14], "iou": [7, 10], "8116431733608086": 7, "9123927497732395": 7, "605203573769534": 7, "hasattr": [7, 10], "image_fil": [7, 10, 13], "cems_cod": [7, 10], "basenam": [7, 8, 9, 10], "split": [7, 10], "file_nam": [7, 8, 10, 13], "list_of_window": [7, 10, 13], "iou_per_cod": [7, 10], "datafram": [7, 9, 10, 11, 14], "group_confus": [7, 10], "confus": [7, 10], "calculate_i": [7, 10], "iou_": [7, 10], "recall_per_cod": [7, 10], "calculate_recal": [7, 10], "recall_": [7, 10], "join_data_per_cod": [7, 10], "merg": [7, 10], "set_index": [7, 10], "across": [7, 10], "axi": [7, 8, 9, 10, 13, 14], "to_dict": [7, 10], "recall_land": [7, 10], "93": [7, 11], "08255820002643": 7, "recall_wat": [7, 10], "45670619858558": 7, "recall_cloud": [7, 10], "76": [7, 10], "05831858902059": 7, "iou_land": [7, 10], "90": [7, 9, 10, 11, 14], "55111450826736": 7, "iou_wat": [7, 10], "68072319568316": 7, "iou_cloud": [7, 10], "91956034880197": 7, "emsr271": 7, "652827": 7, "97": [7, 9, 10], "856891": 7, "792703": 7, "435118": 7, "24": [7, 9, 11, 14, 15], "420104": 7, "70": [7, 10], "859015": 7, "emsr279": 7, "994390": 7, "400188": 7, "984087": 7, "83": [7, 11], "700250": 7, "200438": 7, "255267": 7, "emsr280": 7, "209005": 7, "197996": 7, "264703": 7, "885050": 7, "86": [7, 10], "735377": 7, "49": [7, 8], "392122": 7, "emsr287": 7, "548484": 7, "487523": 7, "077289": 7, "816743": 7, "139818": 7, "221249": 7, "rs2": 7, "95": [7, 10, 11], "479942": 7, "84": 7, "557994": 7, "87": [7, 10], "650254": 7, "563623": 7, "458526": 7, "770675": 7, "st1": 7, "610701": 7, "239645": 7, "580875": 7, "905902": 7, "58": [7, 8, 9, 14], "130076": 7, "88": 7, "019034": 7, "along": 7, "conduct": 7, "atomic_sav": 7, "save_json": 7, "dir": 7, "state_dict": 7, "cofig": [7, 9], "config_file_path": 7, "save_dir": 7, "server": 7, "33mwarn": 7, "without": 7, "preserv": 7, "base_path": 7, "i": [7, 9, 11, 14], "mnt": 7, "h5": 7, "wait": 7, "pid": 7, "3265program": 7, "successfulli": 7, "debug": 7, "intern": [7, 13], "summari": [7, 8], "_runtime619_timestamp1617872011_step1575loss0": 7, "76066epoch3val_bce_loss1": 7, "32021val_dice_loss0": 7, "55334val_recal": 7, "land0": 7, "93818val_recal": 7, "water0": 7, "84217val_recal": 7, "cloud0": 7, "6011val_iou": 7, "89992val_iou": 7, "57418val_iou": 7, "31644": 7, "histori": 7, "_runtim": 7, "_timestamp": 7, "_step": 7, "loss": 7, "val_bce_loss": 7, "val_recal": 7, "val_iou": 7, "864": 7, "media": 7, "artifact": 7, "head": [7, 14], "23": [8, 9, 14], "s2_safe_read": [8, 11], "egg": [8, 14], "timedelta": [8, 9, 14], "warp": 8, "date_ev": [8, 9, 14], "strptime": [8, 9, 11], "date_start_search": [8, 9], "date_end_search": [8, 9, 14], "area_of_interest_geojson": [8, 9], "19": [8, 9, 14, 15], "483318354000062": [8, 9], "41": [8, 9, 14, 15], "84407200000004": [8, 9], "351701478000052": [8, 9], "84053242300007": [8, 9], "298659824000026": [8, 9], "871157520000054": [8, 9], "236388306000038": [8, 9], "89588351100008": [8, 9], "22956438700004": [8, 9], "42": [8, 9, 14, 15], "086957306000045": [8, 9], "327827977000027": [8, 9], "09102668200006": [8, 9], "778082109000025": [8, 9], "10312055000003": [8, 9], "777652446000047": [8, 9], "97309238100007": [8, 9], "777572772000042": [8, 9], "94912981900006": [8, 9], "582705341000064": [8, 9], "94398333100003": [8, 9], "581417139000052": [8, 9], "94394820700006": [8, 9], "54282145700006": [8, 9], "90168177700008": [8, 9], "area_of_interest": [8, 9, 14, 15], "sentinelapi": 8, "usernam": 8, "password": 8, "scihub": 8, "eu": [8, 14], "apihub": 8, "platformnam": 8, "s2msi1c": 8, "cloudcoverpercentag": [8, 11], "products_gpd": 8, "to_geodatafram": 8, "ml4fl_py38": 8, "pyproj": 8, "syntax": 8, "prefer": 8, "mind": 8, "pyproj4": 8, "stabl": 8, "gotcha": 8, "_prepare_from_str": 8, "pjarg": 8, "link_altern": 8, "link_icon": 8, "ondemand": 8, "datatakesensingstart": 8, "beginposit": 8, "endposit": 8, "ingestiond": 8, "platformidentifi": 8, "orbitdirect": 8, "platformserialidentifi": 8, "processinglevel": 8, "identifi": 8, "datastripidentifi": 8, "granuleidentifi": 8, "uuid": 8, "7855c95e": 8, "6e00": 8, "4a7d": 8, "ba8c": 8, "7f8ad5f7beca": 8, "s2b_msil1c_20210218t094029_n0209_r036_t34tcm_2": 8, "odata": 8, "18t09": 8, "024z": 8, "09": [8, 9, 11, 14], "024": 8, "943": [8, 9], "2017": 8, "013a": 8, "descend": 8, "2b": 8, "1c": 8, "s2b_oper_msi_l1c_ds_vgs2_20210218t115327_s2021": 8, "s2b_oper_msi_l1c_tl_vgs2_20210218t115327_a0206": 8, "multipolygon": [8, 15], "60606": 8, "43884": 8, "65397": 8, "6c813d56": 8, "a984": 8, "40bd": 8, "8752": 8, "bee7cbc81146": 8, "s2b_msil1c_20210215t093029_n0209_r136_t34tcm_2": 8, "15t09": 8, "930": 8, "s2b_oper_msi_l1c_ds_epae_20210215t105122_s2021": 8, "s2b_oper_msi_l1c_tl_epae_20210215t105122_a0206": 8, "91997": 8, "row": [8, 15], "column": [8, 15], "product_to_download": 8, "tabl": [8, 9, 14], "024000": 8, "930000": 8, "generationd": 8, "22": [8, 9, 11, 13, 14], "orbitnumb": 8, "20611": 8, "relativeorbitnumb": 8, "136": 8, "9774": 8, "sensoroperationalmod": 8, "INS": 8, "nob": 8, "level1cpdiidentifi": 8, "tileid": 8, "34tcm": 8, "hv_order_tileid": 8, "tm34c": 8, "processingbaselin": 8, "instrumentnam": 8, "multi": [8, 15], "spectral": 8, "instrumentshortnam": 8, "msi": 8, "715": 8, "s2datatakeid": 8, "gs2b_20210215t093029_020611_n02": 8, "60606083644028": 8, "43883628550716": 8, "folder_download": 8, "s2safe_product": 8, "newest": 8, "750m": 8, "20mb": 8, "md5": 8, "checksum": 8, "5mb": 8, "exctract": 8, "s2_safe_fold": [8, 11], "splitext": [8, 9], "s2obj": [8, 11], "s2loader": [8, 11], "out_r": [8, 11], "from_epsg": [8, 15], "32634": [8, 15], "300000": 8, "4700040": 8, "s2imagel1c": 8, "0x7f92654a1be0": 8, "0x7f9267edf220": 8, "bounds_pol_read": 8, "bounds_pol_read_s2cr": 8, "transform_bound": 8, "4326": [8, 11, 14], "reproject": 8, "load_bands_bbox": 8, "2995": 8, "4596": 8, "353008": 8, "60473929264": 8, "4662742": 8, "335279502": 8, "go": [8, 9], "colab": [8, 9, 11, 12, 14, 16], "mount": [8, 9, 14, 16], "exists_ok": 8, "vector": [8, 14], "vectorized_datafram": [8, 9], "suptitl": [8, 9], "fontsiz": [8, 9, 15], "interest": [9, 12, 14, 15], "between": [9, 14, 15], "two": [9, 11, 16], "henc": [9, 16], "account": [9, 14], "export": 9, "those": [9, 15], "timezon": [9, 11, 14], "geemap": [9, 11, 14], "eefolium": [9, 14], "folium": [9, 11, 14], "ee_download": [9, 14], "tzinfo": [9, 11, 14], "utc": [9, 11, 14], "generate_polygon": [9, 14], "bbox": 9, "x1": 9, "y1": 9, "x2": 9, "y2": 9, "x3": 9, "y3": 9, "x4": 9, "y4": 9, "imagecollect": 9, "img_col": [9, 14], "system": [9, 11, 14], "time_start": [9, 11, 14], "valid": [9, 13, 14, 16], "averag": 9, "probabl": [9, 14], "cloud_prob": [9, 14], "img_col_info_loc": [9, 14], "s2cloudless": [9, 15], "independ": 9, "collect": [9, 11, 14], "bounds_pol": [9, 14], "pol_2_clip": [9, 14], "pol": [9, 14], "grab": [9, 14], "get_s2_collect": [9, 14], "permanent_water_img": [9, 14], "permanent_water_imag": [9, 14, 15], "info": [9, 14], "convert": [9, 10, 14, 15], "img_col_info": [9, 14], "img_collection_to_feature_collect": [9, 14], "from_featur": [9, 14], "getinfo": [9, 14], "lambda": [9, 10, 14], "x": [9, 10, 11, 14], "utcfromtimestamp": [9, 14], "n_images_col": [9, 14], "isoformat": [9, 14], "marker": [9, 14], "ylim": [9, 14], "101": [9, 14], "xtick": [9, 14], "rotat": [9, 14], "ylabel": [9, 14], "12t00": 9, "01t00": 9, "percentag": [9, 11], "180": [9, 14], "00000": [9, 14], "254181": 9, "38": [9, 14], "983": 9, "172355": 9, "48": [9, 14], "039": 9, "966141": 9, "39": [9, 14], "993": 9, "029202": 9, "823": 9, "941818": 9, "26": [9, 14], "106": 9, "897624": 9, "986": 9, "000000": [9, 10, 11, 14], "341": 9, "503629": 9, "013119": 9, "531": 9, "999951": 9, "08": [9, 11, 15], "218": 9, "999130": 9, "013": 9, "54": [9, 14], "985": [9, 14], "191459": [9, 14], "363": [9, 14], "315460": [9, 14], "845": [9, 14], "94": [9, 10, 14], "017820": [9, 14], "706": [9, 14], "401171": [9, 14], "862": [9, 14], "978288": [9, 14], "740": [9, 14], "595103": [9, 14], "012": [9, 14], "loop": 9, "seen": [9, 15], "gee": [9, 11, 14, 15], "ll": 9, "imgs_list": [9, 14], "img_show": [9, 14], "addlay": [9, 11, 14], "swir": [9, 14], "strftime": [9, 11, 14], "waterclass": [9, 14], "palett": [9, 14], "cccccc": [9, 14], "ffffff": [9, 14], "99d9ea": [9, 14], "0000ff": [9, 14], "ff000000": [9, 14], "centerobject": [9, 14], "zoom": [9, 14], "layercontrol": [9, 11, 14], "collaps": [9, 11, 14], "add_to": [9, 11, 14], "ve": [9, 15], "googel": 9, "export_to_gcp": 9, "doc": 9, "start": [9, 14], "cred": 9, "path_to_export": 9, "preingest": 9, "bucket_nam": 9, "utm": 9, "aoi_shap": 9, "lon": 9, "centroid": [9, 11], "coord": [9, 11], "convert_wgs_to_utm": 9, "export_task_fun_img": 9, "export_task_imag": 9, "bands_export": [9, 14], "bands_s2_nam": 9, "task": [9, 14], "img_export": [9, 14], "select": [9, 11, 14], "tofloat": [9, 14], "albania_ts_": 9, "desc": 9, "mayberun": 9, "overwrit": 9, "dry_run": 9, "wait_task": 9, "albania_ts_20210116": 9, "albania_ts_20210119": 9, "albania_ts_20210203": 9, "albania_ts_20210205": 9, "albania_ts_20210215": 9, "albania_ts_20210218": 9, "albania_ts_20210223": 9, "albania_ts_20210225": 9, "albania_ts_20210228": 9, "here": [9, 11, 13, 14, 15], "hood": 9, "fsspec": 9, "fs": 9, "filesystem": 9, "requester_pai": 9, "exported_fil": 9, "glob": [9, 10], "size_read": [9, 14, 15], "600": [9, 14], "programat": 9, "second": [9, 14], "downlink": [9, 15], "gdrive": 9, "constrain": 9, "tqdm": [9, 14], "predit": 9, "folder_sav": 9, "ts_output": 9, "name_plot": 9, "to_fil": 9, "geojson": [9, 14, 15], "driver": 9, "savefig": 9, "jpg": 9, "362": 9, "int64index": 9, "appropri": 9, "exec": 9, "matplotlib_inlin": 9, "backend_inlin": 9, "backend": 9, "cannot": 9, "120": 9, "121": 9, "115": 9, "69": [9, 10], "67": [9, 10, 11, 15], "117": 9, "57": [9, 11], "118": 9, "79": [9, 11], "16min": 9, "4s": 9, "4min": 9, "20min": 9, "17min": 9, "date_it": 9, "read_fil": [9, 15], "floodmap_folium": [9, 14], "featur": [9, 14], "add_child": [9, 14], "divid": [10, 16], "test_fold": 10, "1bp1fxppikopqrgth2lu5wjpyx7lb2qow": 10, "del": 10, "worldfloodsdatasettil": 10, "worldfloodsdataset": 10, "bands_read_s2": 10, "test_fil": 10, "get_transform": 10, "image_prefix": [10, 13], "gt_prefix": [10, 13], "lock_read": 10, "There": [10, 11, 13, 16], "skip": [10, 15], "worldfloods_v1_sampl": 10, "emsr286_08ituangonorth_del_monit02_v1_observed_event_a": 10, "emsr286_09ituangosouth_del_monit02_v1_observed_event_a": 10, "emsr333_01rattaloro_del_monit01_v1_observed_event_a": 10, "emsr333_13torrecolonnasperone_del_monit01_v2_observed_event_a": 10, "emsr342_07southnormanton_del_monit03_v2_observed_event_a": 10, "emsr347_06mwanza_del_v1_observed_event_a": 10, "emsr347_07zomba_del_v2_observed_event_a": 10, "emsr9284_01ylitornionorthern_del_monit01_v1_observed_event_a": 10, "shuffl": 10, "v2": [10, 15], "inf_func": 10, "sigmoid": 10, "dual_head_output": 10, "zero": 10, "mask_cloud": 10, "9029077785566316": 10, "8734460214394203": 10, "7296114155197847": 10, "codes_loc": 10, "emsr333": 10, "itali": [10, 14], "emsr9284": 10, "emsr284": 10, "finland": [10, 14], "emsr347": 10, "malawi": [10, 14], "emsr286": 10, "colombia": 10, "emsr342": 10, "australia": [10, 14], "13838818450972": 10, "76496994702889": 10, "21174578522877": 10, "7264665724063": 10, "74": 10, "14875561083508": 10, "01686774881253": 10, "778702": 10, "101370": 10, "995128": 10, "452269": 10, "104708": 10, "259330": 10, "776235": 10, "642480": 10, "119989": 10, "956551": 10, "949436": 10, "404743": 10, "510674": 10, "022392": 10, "000729": 10, "419744": 10, "72": 10, "314018": 10, "287511": 10, "848191": 10, "740996": 10, "942883": 10, "865007": 10, "443802": 10, "132753": 10, "778140": 10, "317612": 10, "938762": 10, "931815": 10, "000002": 10, "sement": 11, "particular": [11, 13, 14], "deriv": [11, 14], "focu": [11, 14], "region": [11, 14, 15], "nova": 11, "kakhovka": 11, "kherson": 11, "ukrain": 11, "where": [11, 15, 16], "recent": 11, "dam": 11, "break": [11, 15], "caus": 11, "save_cog": 11, "window_util": 11, "mosaic": 11, "rasterio_read": 11, "rasterioread": 11, "vectorize_outputv1": 11, "40965055141422": 11, "849975215311474": 11, "24671826582107": 11, "923511440491325": 11, "936224664974134": 11, "845770100334164": 11, "33368262768653": 11, "62876156455022": 11, "25990197005967": 11, "514641087646424": 11, "31216326921171": 11, "408759851523826": 11, "843998842939385": 11, "56961795883814": 11, "21905051921081": 11, "72367854887557": 11, "aoi_gpd": 11, "set_cr": 11, "tz": [11, 14], "start_period": 11, "end_period": 11, "overlap": [11, 15], "flood_images_ge": 11, "flood_collect": 11, "date_start": 11, "date_end": 11, "return_collect": 11, "add_s2cloudless": 11, "groupbi": 11, "overlappercentag": 11, "agg": 11, "count": 11, "s2b": 11, "062169": 11, "434830": 11, "lc08": 11, "070000": 11, "634958": 11, "lc09": 11, "040000": 11, "542523": 11, "788626": 11, "100742": 11, "s2a": 11, "990063": 11, "540035": 11, "760000": 11, "054185": 11, "430000": 11, "152296": 11, "942521": 11, "707824": 11, "foliumap": 11, "tl": 11, "tilelay": 11, "mt1": 11, "vt": 11, "lyr": 11, "attr": 11, "overlai": [11, 14, 15], "max_zoom": 11, "zoom_start": 11, "localdatetime_str": 11, "localdatetim": 11, "dt": 11, "showcolumn": 11, "ff7777": 11, "fffa69": 11, "8fff84": 11, "52adf1": 11, "ff6ac2": 11, "1b6d52": 11, "fce5cd": 11, "705334": 11, "images_dai": 11, "enumer": 11, "outlin": [11, 13], "image_col_day_sat": 11, "filter": [11, 14], "inlist": 11, "b6": [11, 14], "b5": [11, 14], "style_kwd": 11, "fillopac": 11, "black": 11, "By": 11, "post": 11, "date_pr": 11, "pre_flood": 11, "date_post": 11, "post_flood": 11, "utcdatetim": 11, "solardatetim": 11, "s2a_msil1c_20230608t084601_n0509_r107_t36tvs_20230608t104959": 11, "70898": 11, "95835": 11, "70900": 11, "090149": 11, "20230608t084601_20230608t084938_t36tv": 11, "32636": 11, "1686214645530": 11, "s2_harmon": 11, "530000": 11, "282631": 11, "427835": 11, "s2a_msil1c_20230608t084601_n0509_r107_t36tws_20230608t104959": 11, "44238": 11, "94462": 11, "44228": 11, "94471": 11, "989920": 11, "20230608t084601_20230608t084938_t36tw": 11, "1686214640951": 11, "951000": 11, "918853": 11, "363462": 11, "free": 11, "entir": [11, 16], "cloudi": [11, 16], "some": [11, 12, 13, 15], "t36tv": 11, "t36tw": 11, "te": 11, "advantag": 11, "limit": 11, "tak": 11, "dir_cach": 11, "cache_s2": 11, "mosaic_s2": 11, "products_read": 11, "s2_public_bucket_path": 11, "safe": [11, 12], "check_exist": 11, "cache_product_to_local_dir": 11, "polygon_read_dst_cr": 11, "polygon_to_cr": 11, "crs_polygon": 11, "dst_cr": 11, "data_memori": 11, "spatial_mosa": 11, "bands_s2_l1c": 11, "tiff_pr": 11, "pre_flood_memori": 11, "descript": [11, 14], "tiff_post": 11, "post_flood_memori": 11, "5min": 11, "binari": [11, 12, 15, 16], "distinguish_flood_trac": 11, "71": 11, "postflood_pr": 11, "_pred": 11, "pred": 11, "tag": 11, "preflood_pr": 11, "prediction_preflood": 11, "prediction_preflood_cont": 11, "trace": 11, "prediction_preflood_rast": 11, "300": 11, "364": 11, "365": 11, "5700": 11, "8800": 11, "preflood_shap": 11, "postflood_shap": 11, "2893": 11, "plot_floodmap": 11, "prepost_shap": 11, "compute_pre_post_flood_wat": 11, "aggreg": 11, "acquir": [11, 14], "bands_l89": 11, "b7": [11, 14], "postfloodsl9": 11, "l89_image_info": 11, "itertupl": 11, "aoi_dst_cr": 11, "postfloodl9": 11, "post_flood_l9_data": 11, "537": 11, "443205": 11, "5196705": 11, "1900": 11, "2933": 11, "5139705": 11, "531195": 11, "09_pred": 11, "post_flood_shape_l9": 11, "filterwarn": 11, "ignor": 11, "area_imag": 11, "post_flood_shap": 11, "postflood_mosa": 11, "mosaic_floodmap": 11, "classes_wat": 11, "prepost_shape_fin": 11, "isin": 11, "section": [12, 15], "freeli": 12, "standard": [12, 13, 15], "pr": 12, "roc": 12, "curv": 12, "detect": 12, "vs": [12, 13], "probabilist": 12, "net": 12, "bayesian": 12, "ensembl": 12, "classif": [12, 15], "hub": [12, 15], "johnson": [13, 15], "necessari": [13, 15], "receiv": 13, "readi": 13, "world": 13, "hidden": 13, "within": [13, 14, 15], "expos": 13, "reproduc": 13, "hope": 13, "explain": [13, 14], "spark": 13, "crucial": 13, "compli": 13, "torchvis": 13, "starter": 13, "ones": 13, "why": 13, "trick": 13, "correct": 13, "pyprojroot": 13, "spyder": 13, "project_fil": 13, "compat": 13, "dutil": 13, "albument": 13, "preprocess": [13, 14, 15], "wf_normal": 13, "putil": 13, "inlin": 13, "inlinebackend": 13, "figure_format": 13, "retina": 13, "seaborn": 13, "sn": 13, "set_context": 13, "context": 13, "talk": 13, "font_scal": 13, "foremost": 13, "while": [13, 15], "exactli": 13, "groundtruth": 13, "being": 13, "fairli": 13, "take": [13, 14, 15], "peek": 13, "s2_prefix": 13, "s2_demo_imag": 13, "gt_demo_imag": 13, "destin": 13, "s2_destination_dir": 13, "joinpath": 13, "demo_imag": 13, "gt_destination_dir": 13, "s2_demo_gcp_path": 13, "gcppath": 13, "download_file_from_bucket": 13, "gt_demo_gcp_path": 13, "satyarth934": 13, "Is": 13, "posixpath": 13, "ls": [13, 16], "lht": 13, "687m": 13, "rw": 13, "25m": 13, "constant": 13, "tile_height": 13, "tile_width": 13, "dt_idx": 13, "200": [13, 14], "intial": 13, "pt_ds_orig": 13, "get_list_of_window_slic": 13, "windows": 13, "pt_d": 13, "ri": 13, "untiled_image_shap": 13, "nrow": 13, "ncol": 13, "subplots_adjust": 13, "wspace": 13, "hspace": 13, "num_tiles_per_row": 13, "tile_num": 13, "uint8": 13, "off": 13, "set_aspect": 13, "equal": 13, "plot_imag": 13, "demo_image_dict": 13, "dictionari": 13, "nmask": 13, "call": [13, 15], "correspond": 13, "288": 13, "nifti": 13, "firstli": [13, 15], "length": 13, "well": [13, 14], "explicitli": 13, "extract": [13, 14, 15], "notic": [13, 14], "default": 13, "pattern": 13, "sinc": [13, 14], "heavili": 13, "upon": [13, 14], "stick": 13, "scikit": 13, "pillow": 13, "exampl": [13, 14], "accommad": 13, "sake": 13, "matrix": 13, "corner": 13, "reshape_as_imag": 13, "reshap": 13, "too": 13, "contour": 13, "wa": [13, 14, 15, 16], "would": [13, 14, 15], "rightarrow": 13, "On": 13, "contrari": 13, "invers": 13, "again": [13, 15], "mainli": [13, 15, 16], "transform_invpermutechannel": 13, "inversepermutechannel": 13, "transform_permutechannel": 13, "permutechannel": 13, "flavour": 13, "lead": 13, "unchang": 13, "mega_transform": 13, "compos": [13, 14], "matric": 13, "typic": 13, "transform_totensor": 13, "use_channel": 13, "channel_mean": 13, "channel_std": 13, "get_normalis": 13, "transform_norm": 13, "std": 13, "max_pixel_valu": 13, "plot_images_plt": 13, "check_img": 13, "transform_sc": 13, "shift_limit": 13, "001": 13, "scale_limit": 13, "rotate_limit": 13, "transform_channeljitt": 13, "perchannel": 13, "transform_flip": 13, "always_appli": 13, "transform_rr90": 13, "transform_motionblur": 13, "motionblur": 13, "blur_limit": 13, "transform_res": 13, "resizefactor": 13, "abov": 13, "simplifi": 13, "programm": 13, "he": 13, "she": 13, "decid": 13, "automat": [13, 16], "configur": 13, "attrdict": 13, "channels_configur": 13, "downsampling_factor": 13, "gaussnois": 13, "var_limit_low": 13, "var_limit_upp": 13, "from_nested_dict": 13, "transform_param": 13, "servic": 14, "co": 14, "examin": 14, "hydrographi": 14, "assess": 14, "natur": 14, "geospati": 14, "recoveri": 14, "primarili": 14, "fluvial": 14, "uniqu": [14, 15], "webpag": 14, "variou": 14, "respect": 14, "walk": 14, "singl": [14, 15], "alert": 14, "table_floods_em": 14, "far": 14, "Be": 14, "care": 14, "choos": 14, "date": 14, "prior": 14, "june": 14, "2015": 14, "tmp": 14, "ccd3jpat": 14, "ml4floods_8eb3a646692647a49e9ba6678b10471c": 14, "command": 14, "blob": 14, "31merror": 14, "cancel": 14, "31m": 14, "copernicusem": 14, "occur": [14, 15], "table_activations_em": 14, "event_start_d": 14, "coded": 14, "countri": 14, "emsr568": 14, "cyclon": 14, "gomb": 14, "mozambiqu": 14, "emsr567": 14, "queensland": 14, "emsr565": 14, "tropic": 14, "emnati": 14, "madagascar": 14, "storm": 14, "emsr564": 14, "batsirai": 14, "emsr563": 14, "r\u00e9union": 14, "reunion": 14, "emsr562": 14, "emsr561": 14, "emsr559": 14, "emsr557": 14, "norwai": 14, "emsr556": 14, "typhoon": 14, "rai": 14, "philippin": 14, "emsr555": 14, "ebro": 14, "basin": 14, "spain": 14, "emsr554": 14, "emsr552": 14, "windstorm": 14, "emsr551": 14, "sulaymaniyah": 14, "district": 14, "iraq": 14, "emsr550": 14, "south": 14, "wale": 14, "emsr548": 14, "eastern": 14, "sicili": 14, "emsr520": 14, "netherland": 14, "emsr519": 14, "switzerland": 14, "emsr518": 14, "belgium": 14, "emsr517": 14, "western": 14, "germani": 14, "emsr514": 14, "guyana": 14, "emsr511": 14, "lapland": 14, "emsr507": 14, "timor": 14, "lest": 14, "emsr504": 14, "emsr502": 14, "southern": 14, "ireland": 14, "emsr498": 14, "corr\u00e8z": 14, "depart": 14, "franc": 14, "emsr497": 14, "emsr496": 14, "lazio": 14, "emsr495": 14, "elois": 14, "eswatini": 14, "zimbabw": 14, "emsr492": 14, "heavi": 14, "4000": 14, "hectar": 14, "affect": 14, "impact": 14, "entri": 14, "januari": 14, "6th": 14, "fetch": 14, "fetch_zip_fil": 14, "string": 14, "emsr_cod": 14, "zip_files_activation_url_list": 14, "fetch_zip_file_url": 14, "184632": 14, "emsr501_aoi01_del_monit02_r1_vectors_v1_vector": 14, "184615": 14, "emsr501_aoi01_del_monit01_r1_vectors_v1_vector": 14, "184606": 14, "emsr501_aoi01_del_product_r1_vectors_v1_vector": 14, "raw": 14, "0_raw": 14, "copernicus_em": 14, "copernicus_ems_zip": 14, "copernicus_ems_unzip": 14, "goe": 14, "finish": 14, "folder_out": 14, "copernicus_ems_raw": 14, "unzip_files_activ": 14, "zip_fil": 14, "local_zip_fil": 14, "download_vector_cem": 14, "unzipped_fil": 14, "unzip_copernicus_em": 14, "332": 14, "11it": 14, "Not": 14, "scrape": 14, "shp": 14, "repres": 14, "crisi": 14, "lake": [14, 15], "floodmask": 14, "supervis": 14, "filter_register_copernicusem": 14, "convent": 14, "timestamp": 14, "kei": 14, "hold": 14, "generate_floodmap": 14, "code_d": 14, "regist": 14, "unzip_fold": 14, "metadata_floodmap": [14, 15], "folder_fil": 14, "won": 14, "shapelydeprecationwarn": 14, "cascaded_union": 14, "unary_union": 14, "land_geometri": 14, "w_class": [14, 15], "49257": 14, "09545": 14, "49258": 14, "09541": [14, 15], "51681": 14, "09338": 14, "09329": 14, "50074": 14, "09272": 14, "09263": 14, "50933": 14, "09266": 14, "09257": 14, "50763": 14, "09290": 14, "09281": 14, "hydro": [14, 15], "hydro_l": 14, "blue": 14, "emsr501_aoi01_del_product": 14, "emsr501_aoi01_del_product_observedeventa_r1_v1": 14, "flash": 14, "0000": 14, "nan": 14, "box": 14, "west": 14, "238301964000073": 14, "east": 14, "710555657000043": 14, "north": 14, "095451798000056": 14, "873487114000056": 14, "refer": 14, "abstract": 14, "area_of_interest_polygon": 14, "0x7f56811326d0": 14, "observed_event_fil": 14, "area_of_interest_fil": 14, "emsr501_aoi01_del_product_areaofinteresta_r1_v1": 14, "ems_cod": 14, "aoi_cod": 14, "date_ems_cod": 14, "satellite_pre_ev": 14, "street": 14, "timestamp_pre_ev": 14, "hydrology_fil": 14, "emsr501_aoi01_del_product_hydrographya_r1_v1": 14, "hydrology_file_l": 14, "emsr501_aoi01_del_product_hydrographyl_r1_v1": 14, "sure": 14, "sign": 14, "georeferenc": 14, "render": 14, "create_gt": [14, 15], "earthengin": 14, "viz": 14, "12t16": 14, "04t16": 14, "previou": [14, 15], "coverag": 14, "042142": 14, "135": 14, "b1": 14, "b8a": 14, "b9": 14, "b10": 14, "b12": 14, "qa60": 14, "date_i": 14, "filename_noext": 14, "ml4floods_flood_albania": 14, "tostorag": 14, "todriv": 14, "filenameprefix": 14, "skipemptytil": 14, "formatopt": 14, "cloudoptim": 14, "filedimens": 14, "12544": 14, "maxpixel": 14, "5e9": 14, "statu": 14, "state": 14, "creation_timestamp_m": 14, "1617123790366": 14, "update_timestamp_m": 14, "1617123855192": 14, "start_timestamp_m": 14, "1617123840398": 14, "task_typ": 14, "export_imag": 14, "attempt": 14, "phodtjsjbmopvzvjl7s5hs6": 14, "legaci": 14, "part": 14, "about": 15, "forthcom": 15, "extra": 15, "basi": 15, "demonstr": 15, "s2_img_path": 15, "products_sample_tutori": 15, "1wpxbasa5kaeikpyu78ryzshjeuzalyel": 15, "prep": 15, "560m": 15, "8mb": 15, "800": 15, "advanc": 15, "consult": 15, "special": 15, "what": 15, "fortun": 15, "simpli": 15, "get_image_transform": 15, "cmap": 15, "One": 15, "veri": 15, "conveni": 15, "blog": 15, "showcas": 15, "cloudmask": 15, "resum": 15, "cloud_mask": 15, "compute_s2cloudless_prob": 15, "calcul": 15, "cloudless": 15, "s2_cloud_prob": 15, "s2_rst": 15, "jrc_img_path": 15, "1n_nf9xdo4qse2bp76t0szhroo24fd": 15, "xt": 15, "314k": 15, "19mb": 15, "interpol": 15, "nearest": 15, "come": 15, "drought": 15, "floodmap_path": 15, "1gs1_9fxwrydgu7o": 15, "0ru4i8ixch4pvpqc": 15, "9m": 15, "4mb": 15, "floodmap_df": 15, "48718": 15, "48706": 15, "48966": 15, "09551": 15, "09540": 15, "48887": 15, "09549": 15, "09547": 15, "48967": 15, "09486": 15, "09481": 15, "48731": 15, "09523": 15, "09518": 15, "2046": 15, "43283": 15, "90527": 15, "90518": 15, "2047": 15, "43063": 15, "90832": 15, "43064": 15, "90823": 15, "2048": 15, "43015": 15, "90893": 15, "90884": 15, "2049": 15, "43065": 15, "90295": 15, "90304": 15, "2050": 15, "42929": 15, "91042": 15, "91033": 15, "2051": 15, "bh080": 15, "bh130": 15, "reservoir": 15, "bh140": 15, "bh141": 15, "bank": 15, "ba040": 15, "ba010": 15, "coastlin": 15, "That": 15, "rememb": 15, "floodmap_df_utm": 15, "to_cr": 15, "clear": [15, 16], "beyond": 15, "onto": 15, "geocoordin": 15, "piec": 15, "togeth": 15, "bit": 15, "fuse": 15, "resourc": 15, "logist": 15, "regress": 15, "poorli": 15, "due": 15, "complex": 15, "might": 15, "gt_meta": 15, "generate_land_water_cloud_gt": 15, "keep_stream": 15, "permanent_water_image_path": 15, "gtversion": 15, "encoding_valu": 15, "2996": 15, "4597": 15, "s2_image_path": 15, "cloudprob_image_path": 15, "6472757": 15, "250244": 15, "1559933": 15, "5489678": 15, "561790": 15, "212124": 15, "786019": 15, "boundingbox": 15, "left": 15, "353000": 15, "bottom": 15, "4632790": 15, "398970": 15, "4662750": 15, "newaxi": 15, "gt_binari": 15, "gt_meta_binari": 15, "generate_water_cloud_binary_gt": 15, "6472855": 15, "1564991": 15, "5725159": 15, "562505": 15, "219225": 15, "787354": 15, "173": 15, "216": 15, "230": 15, "cmap_cat": 15, "norm_cat": 15, "im_plt": 15, "norm": 15, "set_axis_off": 15, "0x7faf1f253e20": 15, "509": 16, "approxim": 16, "300gb": 16, "hard": 16, "disk": 16, "2016": 16, "curat": 16, "anoth": 16, "metadata": 16, "8153514": 16, "request": 16, "pai": 16, "gsutil": 16, "cp": 16, "train_sampl": 16, "train_v1_0": 16, "train_sample_v1_0": 16, "val_v1_0": 16, "test_v1_0": 16, "mkdir": 16, "wfv1_scnn20": 16}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"creat": 0, "doc": 0, "publish": 0, "packag": [0, 6, 10, 11, 13], "pip": 0, "introduct": [1, 2], "instal": [1, 8, 11], "tutori": [1, 15], "citat": 1, "about": 1, "contributor": 1, "democratis": 2, "ai": 2, "enhanc": 2, "flood": [2, 5, 7, 10, 11, 14, 15], "tool": 2, "mlop": [2, 12], "from": [2, 5, 7, 8, 14, 16], "data": [2, 4, 5, 6, 7, 10, 11, 13, 15, 16], "prepar": [2, 5], "deploy": 2, "understand": 2, "us": [2, 5, 14], "viewer": 3, "label": 3, "editor": 3, "brief": [3, 13, 15], "descript": [3, 13, 15], "probabilist": 4, "neural": 4, "network": 4, "step": [4, 5, 6, 7, 8, 9, 10, 11, 15], "0": [4, 6, 7, 8, 10, 15], "notebook": [4, 6, 10], "setup": [4, 7], "1": [4, 6, 7, 8, 9, 10, 11, 13, 14], "configur": [4, 7], "file": [4, 7, 8, 9, 13, 14], "2": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15], "dataload": [4, 7, 10], "3": [4, 6, 7, 8, 9, 10, 11, 13, 14, 15], "load": [4, 5, 6, 8, 10, 11], "pre": [4, 6, 13], "train": [4, 5, 6, 7, 10], "model": [4, 5, 6, 7, 10, 11, 15], "checkpoint": 4, "4": [4, 6, 7, 8, 9, 10, 11, 13], "get": [4, 6, 10], "infer": [4, 5, 6, 8, 9, 10, 11], "function": [4, 5], "5": [4, 7, 8, 9, 10, 13], "run": [4, 5, 6, 8, 9, 10, 11], "over": [4, 8, 9], "dataset": [4, 7, 10], "show": [4, 7, 9, 14, 15], "visual": [4, 13], "uncertainti": 4, "segment": [4, 5], "6": [4, 7, 9, 13], "try": [4, 5], "out": 4, "some": [4, 5, 7], "new": [4, 5], "cloud": [5, 9, 15], "awar": 5, "ml4flood": 5, "sentinel": [5, 8, 9, 11, 14], "download": [5, 6, 7, 8, 9, 10, 13, 16], "imag": [5, 7, 8, 9, 10, 13, 14, 15], "plot": [5, 6, 7, 8, 9, 13, 15], "result": [5, 7, 8], "landsat": [5, 11], "more": [5, 13], "exampl": 5, "read": [5, 8, 11, 14], "gcp": 5, "bucket": [5, 16], "helper": 5, "demo": [5, 13, 15], "perform": 5, "inference_funct": [5, 8], "let": 5, "anoth": 5, "janitor": 5, "licenc": [5, 11], "necessari": [6, 11], "0a": [6, 7, 10, 15], "mount": [6, 7, 10, 15], "public": [6, 7, 10, 15], "folder": [6, 7, 10, 13, 15], "you": [6, 7, 10, 15], "ar": [6, 7, 10, 15], "googl": [6, 7, 10, 14, 15, 16], "colab": [6, 7, 10, 15], "0b": [6, 7, 10], "gdown": [6, 10], "jupyt": [6, 10], "config": [6, 9, 10, 13], "vectoris": 6, "water": [6, 14, 15], "mask": [6, 13, 15], "them": 6, "unzip": [7, 8, 14], "worldflood": [7, 16], "sampl": 7, "seed": 7, "everyth": 7, "reproduc": 7, "b": 7, "make": 7, "uniqu": 7, "experi": 7, "option": 7, "set": 7, "up": 7, "weight": 7, "bias": 7, "logger": 7, "lightn": 7, "callback": 7, "light": 7, "trainer": 7, "start": 7, "7": [7, 9], "eval": 7, "predict": [7, 11], "val": 7, "each": [7, 10], "event": [7, 14, 15], "valid": 7, "8": [7, 11], "save": [7, 14], "finish": 7, "connect": 7, "safe": 8, "sentinelsat": 8, "copernicu": [8, 14], "open": 8, "hub": 8, "defin": [8, 11], "area": [8, 11], "interest": [8, 11], "date": [8, 9, 11], "search": [8, 9], "product": [8, 11], "queri": [8, 11], "aoi": [8, 9], "polygon": 8, "5a": 8, "5b": 8, "time": 9, "seri": 9, "s2": [9, 15], "coverag": 9, "avail": 9, "displai": 9, "check": [9, 13], "vector": [9, 11], "floodmap": [9, 11, 14, 15], "an": 9, "interact": 9, "map": [9, 14], "metric": 10, "If": 10, "all": [10, 13], "test": 10, "comput": 10, "postprocess": 11, "import": 11, "paramet": 11, "prepost": 11, "9": 11, "join": 11, "overview": [12, 14], "process": [13, 14], "demonstr": 13, "tldr": 13, "inform": 13, "preambl": 13, "ensur": 13, "were": 13, "correctli": 13, "respect": 13, "worldfloodsdatasettil": 13, "so": 13, "now": 13, "we": 13, "can": 13, "init": 13, "our": 13, "predefin": 13, "class": [13, 15], "tile": 13, "origin": [13, 15], "nice": 13, "attribut": 13, "note": 13, "shape": 13, "covari": 13, "between": 13, "differ": 13, "channel": [13, 15], "input": 13, "transform": 13, "util": 13, "permut": 13, "To": 13, "tensor": 13, "special": 13, "normal": 13, "shiftscalerot": 13, "per": 13, "band": 13, "flip": 13, "randomrotate90": 13, "motion": 13, "blur": 13, "resiz": 13, "stack": 13, "togeth": 13, "compar": 13, "A": 13, "correl": 13, "seen": 13, "ingest": 14, "extent": 14, "em": 14, "rapid": 14, "activ": 14, "emsr": 14, "501": 14, "shkodra": 14, "albania": 14, "retriev": 14, "zip": 14, "url": 14, "given": 14, "code": 14, "local": 14, "build": 14, "metadata": 14, "2a": 14, "shapefil": 14, "2b": 14, "popul": 14, "dictionari": 14, "2c": 14, "gener": 14, "jrc": 14, "perman": [14, 15], "imageri": 14, "earth": 14, "engin": 14, "export": 14, "one": 14, "drive": [14, 16], "ground": 15, "truth": 15, "access": 15, "thi": 15, "last": 15, "probabl": 15, "base": 15, "figur": 15, "On": 15, "problem": 15, "The": 16, "databas": 16, "v2": 16, "zenodo": 16, "v1": 16}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})